#!/bin/bash

set -euo pipefail

JAVA_VERSION=$( java -version 2>&1 | head -n 1 | cut -d'"' -f2| cut -d '.' -f 2 )

if [ ${CDI} = cdi-2.0 ] && [ ${JAVA_VERSION} = 10 ]; then
    echo building with coverage on sonarcloud
    mvn test -P${CDI} jacoco:report sonar:sonar
else
    echo building without coverage
    mvn test -P${CDI}
fi